    <script>
        function search() {
            var cin = document.getElementById('cinInput').value.trim();

            if (cin !== '') {
                var filePath = 'data.xlsx';
                var xhr = new XMLHttpRequest();
                xhr.open('GET', filePath, true);
                xhr.responseType = 'arraybuffer';

                xhr.onload = function(e) {
                    if (xhr.status == 200) {
                        var data = new Uint8Array(xhr.response);
                        var workbook = XLSX.read(data, { type: 'array' });
                        var sheetName = workbook.SheetNames[0];
                        var sheet = workbook.Sheets[sheetName];

                        var jsonData = XLSX.utils.sheet_to_json(sheet);

                        var filteredData = jsonData.filter(function(row) {
                            return String(row.CIN).toLowerCase() === cin.toLowerCase();
                        });

                        var messageDisplay = document.getElementById('messageDisplay');

                        if (filteredData.length > 0) {
                            console.log("Filtered Data:", filteredData);

                            var contentHTML = '<p> CIN ' + cin + ' :</p>';
                            contentHTML += '<div class="table-responsive">';
                            contentHTML += '<table class="table table-bordered table-striped table-hover">';
                            contentHTML += '<thead class="thead-dark"><tr>';
                            
                            var columnsToShow = ['CIN', 'Mat', 'Nom et Prénom', 'Cat. de prêt', 'Solde', 'Fin'];

                            columnsToShow.forEach(function(column) {
                                contentHTML += '<th scope="col">' + column + '</th>';
                            });

                            contentHTML += '</tr></thead><tbody>';

                            filteredData.forEach(function(row) {
                                console.log("Row Data:", row);

                                contentHTML += '<tr>';
                                contentHTML += '<td>' + row['CIN'] + '</td>';
                                contentHTML += '<td>' + row['Mat'] + '</td>';
                                contentHTML += '<td>' + row['Matricule'] + '</td>'; // Assuming Matricule is now Nom et Prénom
                                contentHTML += '<td>' + row['Cat. de prêt'] + '</td>';
                                contentHTML += '<td>' + row['Solde'] + '</td>';
                                contentHTML += '<td>' + row['Fin'] + '</td>';
                                contentHTML += '</tr>';
                            });

                            contentHTML += '</tbody></table>';
                            contentHTML += '</div>';
                            messageDisplay.innerHTML = contentHTML;
                        } else {
                            messageDisplay.innerHTML = '<p>Aucune donnée trouvée pour CIN ' + cin + '.</p>';
                        }
                    } else {
                        console.error('Échec du chargement du fichier Excel. Code d\'état :', xhr.status);
                    }
                };

                xhr.onerror = function(e) {
                    console.error('Une erreur s\'est produite lors du chargement du fichier Excel.', e);
                };

                xhr.send();
            } else {
                alert('Veuillez entrer un CIN valide.');
            }
        }
    </script>
